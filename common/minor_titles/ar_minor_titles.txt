title_knight = {
	dignity = 0.05
	grant_limit = 5
	opinion_effect = 5
	show_as_title = yes
	realm_in_name = yes
	
	monthly_salary = 0.05
	monthly_prestige = 0.50

	allowed_to_grant = {
		is_feudal = yes
		religion_group = christian
		date >= 700.1.1
	}
	
	allowed_to_hold = {
		religion_group = christian
		NOT = { government = theocracy_government }
		NOT = { 
			primary_title = { temporary = yes } 
		}
		martial >= 12
		liege = { character = FROM }
		OR = {
			AND = {
				OR = {
					male_can_hold_minor_title_trigger = yes
					female_can_hold_minor_commander_title_trigger = yes
				}
				OR = {
					NOT = { religion = hindu }
					trait = kshatriya
				}
				is_adult = yes
			}
			has_character_flag = special_marshal
		}
		
		prisoner = no
		NOT = { trait = incapable }
		NOT = { is_inaccessible_trigger = yes }
		NOT = { has_character_flag = guru }
		NOT = { has_character_modifier = refusing_to_lead }
		OR = { 
			NOT = { liege = { has_law = succ_byzantine_elective } }  #Either not Imperial...
			higher_real_tier_than = BARON #...Or potential commander is vassal...
			has_job_title = job_marshal
			NOT = { #...Or there are no valid vassal candidates that can be commanders.
				custom_tooltip = { 
					text = tooltip_byzantine_empire_can_appoint_commanders
					liege = { 
						any_vassal = { 
							higher_real_tier_than = BARON
							NOT = { 
								primary_title = { temporary = yes } 
							}
							OR = {
								AND = {
									OR = {
										male_can_hold_minor_title_trigger = yes
										female_can_hold_minor_commander_title_trigger = yes
									}
									OR = {
										NOT = { religion = hindu }
										trait = kshatriya
									}
									is_adult = yes
								}
								has_character_flag = special_marshal
							}
							
							prisoner = no
							NOT = { trait = incapable }
							NOT = { is_inaccessible_trigger = yes }
							NOT = { has_character_flag = guru }
							NOT = { has_character_modifier = refusing_to_lead }
							NOR = {
								has_job_title = job_chancellor
								#has_job_title = job_marshal
								has_job_title = job_treasurer
								has_job_title = job_spymaster
								has_job_title = job_spiritual
								has_minor_title = title_commander
							}
						} 
					} 
				} 
			}
		}
	}

	gain_effect = {
		remove_trait = ar_knight_muslim
		add_trait = ar_knight
	}
	lose_effect = {
		remove_trait = ar_knight
	}

	message = yes
}

title_knight_muslim = {
	dignity = 0.05
	grant_limit = 5
	opinion_effect = 5
	show_as_title = yes
	realm_in_name = yes
	
	monthly_salary = 0.05
	monthly_prestige = 0.50

	allowed_to_grant = {
		is_feudal = yes
		religion_group = muslim
		date >= 700.1.1
	}
	
	allowed_to_hold = {
		religion_group = muslim
		NOT = { government = theocracy_government }
		NOT = { 
			primary_title = { temporary = yes } 
		}
		martial >= 12
		liege = { character = FROM }
		OR = {
			AND = {
				OR = {
					male_can_hold_minor_title_trigger = yes
					female_can_hold_minor_commander_title_trigger = yes
				}
				OR = {
					NOT = { religion = hindu }
					trait = kshatriya
				}
				is_adult = yes
			}
			has_character_flag = special_marshal
		}
		
		prisoner = no
		NOT = { trait = incapable }
		NOT = { is_inaccessible_trigger = yes }
		NOT = { has_character_flag = guru }
		NOT = { has_character_modifier = refusing_to_lead }
		OR = { 
			NOT = { liege = { has_law = succ_byzantine_elective } }  #Either not Imperial...
			higher_real_tier_than = BARON #...Or potential commander is vassal...
			has_job_title = job_marshal
			NOT = { #...Or there are no valid vassal candidates that can be commanders.
				custom_tooltip = { 
					text = tooltip_byzantine_empire_can_appoint_commanders
					liege = { 
						any_vassal = { 
							higher_real_tier_than = BARON
							NOT = { 
								primary_title = { temporary = yes } 
							}
							OR = {
								AND = {
									OR = {
										male_can_hold_minor_title_trigger = yes
										female_can_hold_minor_commander_title_trigger = yes
									}
									OR = {
										NOT = { religion = hindu }
										trait = kshatriya
									}
									is_adult = yes
								}
								has_character_flag = special_marshal
							}
							
							prisoner = no
							NOT = { trait = incapable }
							NOT = { is_inaccessible_trigger = yes }
							NOT = { has_character_flag = guru }
							NOT = { has_character_modifier = refusing_to_lead }
							NOR = {
								has_job_title = job_chancellor
								#has_job_title = job_marshal
								has_job_title = job_treasurer
								has_job_title = job_spymaster
								has_job_title = job_spiritual
								has_minor_title = title_commander
							}
						} 
					} 
				} 
			}
		}
	}

	gain_effect = {
		remove_trait = ar_knight
		add_trait = ar_knight_muslim
	}
	lose_effect = {
		remove_trait = ar_knight_muslim
	}

	message = yes
}